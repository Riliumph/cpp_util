# ロガーはどうあるべきか

sinkローテーションは以下の問題点があった。

- トリガーがログ書き込みなため厳密な時間管理ができない
- システムの中断が挟まると時間制約が存在する

## ファイル名に厳密な時間は必要ない

ログはアラート時刻に加えて前後数分のログを見る。  
そのためファイル名を厳密にしておく必要があると思われがちである。

しかし、それは検索機能側で何とでもなる内容である。  
AWS Athenaなどで検索するにしても、大事なのは正しいログの時刻がログファイル内に書かれていることである。  
ローテーションしたログファイルの時刻が厳密である必要はない。

## そもそもログローテーションが付帯系のシステム

ログローテーションなんてのは無くてもシステムは稼働する。  
システムに根付いているロガーで行うものではないという考え方もある。

それこそ、Linuxの`logrotate`をcronやjobで行う事が簡単な解決方法である。  

## そもそもローテーションが必要ない仕組みへ

ログをローテーションする必要性は以下だろう。

- ログファイルが巨大で開けないこと
- ログファイルによってストレージを圧迫してしまうこと

こんなものはログローテーションで解決することではないのかもしれない。  
例えば、NoSQLのDBへ転送することやAWS S3などのストレージサーバーへ転送してしまうことが考えられる。  
もっというと、その転送だってローカルマシンのファイルを経由せずログストリーミングで常にネットワーク越しにログを書き続けることも考えられる。

ログローテーションが問題であるなら、問題のないログローテーションを考えるよりもログストリーミングなど別の手段を講じた方が早い可能性もある。
